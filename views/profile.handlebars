<main class="container white-text">
    {{#if (isDefined user)}}
    <h1>{{user.userName}}'s Profile</h1>

    {{#if loggedIn}} {{!-- Check if loggedin --}}
        {{#unless isOwnProfile}} {{!-- Check if NOT viewing own profile --}}
            {{#if (canAddFriend user loggedInId)}} {{!-- Check if user can be added as a friend--}}
            <a id="button-add-friend" class="waves-effect waves-light btn deep-purple">Add Friend</a>
            {{else}} {{!-- User cannot be added as a friend --}}
                {{#if (canAddFriend user loggedInId)}}  {{!-- Check if user being viewed has a request with the logged in user --}}
                    {{#if (isFriender user loggedInId)}} {{!-- Check if user being viewed received the friend request --}}
                    <p>Waiting for user.name to respond</p>
                    {{else}} {{!-- The user being viewed sent the friend request, so logged in user must accept the friend request --}}
                    <a id="button-accept-friend" class="waves-effect waves-light btn deep-purple">Accept Friend Request</a>
                    {{/if}}
                {{/if}}
            {{/if}}
        {{/unless}}
    {{/if}}

    <p class="flow-text">Gamertags:</p>
    <ul>
        {{#each user.gamerTags}}
        <li>{{this.name}}</li>
        {{/each}}
    </ul>

    <p class="flow-text">Games:</p>
    <ul>
        {{#each user.games}}
        <li>{{this.name}}</li>
        {{/each}}
    </ul>

    <p class="flow-text">Friends:</p>
    <ul>
        {{#each user.friends}}
        <li><a href="/profile/{{this.id}}">{{this.userName}}</a> - {{#if this.isFriend}} Friend {{else}} Request
            pending {{/if}}</li>
        {{/each}}
    </ul>
    {{else}}
    <h1>This user doesn't exist</h1>
    {{/if}}
</main>